{"remainingRequest":"E:\\stray_animal\\vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\stray_animal\\vue\\src\\views\\front\\Donate.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\stray_animal\\vue\\src\\views\\front\\Donate.vue","mtime":1746379213661},{"path":"E:\\stray_animal\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\stray_animal\\vue\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\stray_animal\\vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\stray_animal\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\stray_animal\\vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGlhbG9nVmlzaWJsZTogZmFsc2UsCiAgICAgIGxvZ2lzdGljc0RldGFpbDogbnVsbCwKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIGVycm9yTXNnOiAnJywKICAgICAgZG9uYXRlUmVjb3JkczogW10sCiAgICAgIGV4cHJlc3NDb21wYW5pZXM6IHsKICAgICAgICAneXVuZGEnOiAn5ZyG6YCa6YCf6YCSJywKICAgICAgICAnemhvbmd0b25nJzogJ+S4remAmuW/q+mAkicsCiAgICAgICAgJ3NodW5mZW5nJzogJ+mhuuS4sOmAn+i/kCcsCiAgICAgICAgJ3l1YW50b25nJzogJ+WchumAmumAn+mAkicsCiAgICAgICAgJ2Vtcyc6ICdFTVMnLAogICAgICAgICdzaGVudG9uZyc6ICfnlLPpgJrlv6vpgJInLAogICAgICAgICdodWl0b25na3VhaWRpJzogJ+axh+mAmuW/q+i/kCcsCiAgICAgICAgJ2pkJzogJ+S6rOS4nOeJqea1gScsCiAgICAgICAgJ3poYWlqaXNvbmcnOiAn5a6F5oCl6YCBJywKICAgICAgICAndGlhbnRpYW4nOiAn5aSp5aSp5b+r6YCSJwogICAgICB9LAogICAgICBleHByZXNzU3RhdGVzOiB7CiAgICAgICAgJzAnOiB7IHRleHQ6ICflnKjpgJQnLCB0eXBlOiAnaW5mbycgfSwKICAgICAgICAnMSc6IHsgdGV4dDogJ+aPveaUticsIHR5cGU6ICdwcmltYXJ5JyB9LAogICAgICAgICcyJzogeyB0ZXh0OiAn55aR6Zq+JywgdHlwZTogJ3dhcm5pbmcnIH0sCiAgICAgICAgJzMnOiB7IHRleHQ6ICfnrb7mlLYnLCB0eXBlOiAnc3VjY2VzcycgfSwKICAgICAgICAnNCc6IHsgdGV4dDogJ+mAgOetvicsIHR5cGU6ICdkYW5nZXInIH0sCiAgICAgICAgJzUnOiB7IHRleHQ6ICfmtL7ku7YnLCB0eXBlOiAncHJpbWFyeScgfSwKICAgICAgICAnNic6IHsgdGV4dDogJ+mAgOWbnicsIHR5cGU6ICdkYW5nZXInIH0sCiAgICAgICAgJzcnOiB7IHRleHQ6ICfovazmipUnLCB0eXBlOiAnd2FybmluZycgfSwKICAgICAgICAnOCc6IHsgdGV4dDogJ+a4heWFsycsIHR5cGU6ICdpbmZvJyB9LAogICAgICAgICcxNCc6IHsgdGV4dDogJ+aLkuetvicsIHR5cGU6ICdkYW5nZXInIH0KICAgICAgfQogICAgfQogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMubG9hZCgpCiAgfSwKICBtZXRob2RzOiB7CiAgICBsb2FkKCkgewogICAgICB0aGlzLnJlcXVlc3QuZ2V0KCIvZG9uYXRlL3BhZ2UiLCB7CiAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICBwYWdlTnVtOiAxLAogICAgICAgICAgcGFnZVNpemU6IDEwCiAgICAgICAgfQogICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcy5jb2RlID09PSAnMjAwJykgewogICAgICAgICAgdGhpcy5kb25hdGVSZWNvcmRzID0gcmVzLmRhdGEucmVjb3JkcwogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICAvLyDmn6Xor6LnianmtYHkv6Hmga8KICAgIGFzeW5jIHF1ZXJ5TG9naXN0aWNzKHJvdykgewogICAgICBpZiAoIXJvdy5leHByZXNzTm8pIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ+ivpeiusOW9leaaguaXoOW/q+mAkuWNleWPtycpCiAgICAgICAgcmV0dXJuCiAgICAgIH0KCiAgICAgIHRyeSB7CiAgICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gdHJ1ZQogICAgICAgIHRoaXMubG9hZGluZyA9IHRydWUKICAgICAgICB0aGlzLmxvZ2lzdGljc0RldGFpbCA9IG51bGwKICAgICAgICB0aGlzLmVycm9yTXNnID0gJycKCiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnJlcXVlc3QuZ2V0KGAvZG9uYXRlL2V4cHJlc3MveXVhbnRvbmcvJHtyb3cuZXhwcmVzc05vfWApCiAgICAgICAgY29uc29sZS5sb2coJ+eJqea1geafpeivouWTjeW6lDonLCByZXNwb25zZSkKICAgICAgICAKICAgICAgICBpZiAocmVzcG9uc2UuY29kZSA9PT0gJzIwMCcgJiYgcmVzcG9uc2UuZGF0YSkgewogICAgICAgICAgdGhpcy5sb2dpc3RpY3NEZXRhaWwgPSByZXNwb25zZS5kYXRhCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuZXJyb3JNc2cgPSByZXNwb25zZS5tc2cgfHwgJ+eJqea1geS/oeaBr+afpeivouWksei0pScKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+eJqea1geafpeivoumUmeivrzonLCByZXNwb25zZSkKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign6K+35rGC6ZSZ6K+vOicsIGVycm9yKQogICAgICAgIHRoaXMuZXJyb3JNc2cgPSBlcnJvci5yZXNwb25zZT8uZGF0YT8ubXNnIHx8IGVycm9yLm1lc3NhZ2UgfHwgJ+ivt+axguWksei0pScKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgICB9CiAgICB9LAogICAgLy8g6I635Y+W5b+r6YCS5YWs5Y+45ZCN56ewCiAgICBnZXRFeHByZXNzQ29tcGFueU5hbWUoY29kZSkgewogICAgICByZXR1cm4gdGhpcy5leHByZXNzQ29tcGFuaWVzW2NvZGVdIHx8IGNvZGUKICAgIH0sCiAgICAvLyDojrflj5bnianmtYHnirbmgIHmlofmnKwKICAgIGdldFN0YXRlVGV4dChzdGF0ZSkgewogICAgICByZXR1cm4gdGhpcy5leHByZXNzU3RhdGVzW3N0YXRlXT8udGV4dCB8fCAn5pyq55+l54q25oCBJwogICAgfSwKICAgIC8vIOiOt+WPlueJqea1geeKtuaAgeexu+WeiwogICAgZ2V0U3RhdGVUeXBlKHN0YXRlKSB7CiAgICAgIHJldHVybiB0aGlzLmV4cHJlc3NTdGF0ZXNbc3RhdGVdPy50eXBlIHx8ICdpbmZvJwogICAgfQogIH0KfQo="},{"version":3,"sources":["Donate.vue"],"names":[],"mappings":";AAwEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Donate.vue","sourceRoot":"src/views/front","sourcesContent":["<template>\n  <div class=\"donate-container\">\n    <!-- 捐赠记录表格 -->\n    <el-table :data=\"donateRecords\" border style=\"width: 100%\">\n      <el-table-column prop=\"time\" label=\"日期\" width=\"150\"></el-table-column>\n      <el-table-column prop=\"name\" label=\"捐赠人\" width=\"120\"></el-table-column>\n      <el-table-column prop=\"goods\" label=\"物品\"></el-table-column>\n      <el-table-column prop=\"expressNo\" label=\"快递单号\" width=\"180\"></el-table-column>\n      <el-table-column label=\"操作\" width=\"120\">\n        <template slot-scope=\"scope\">\n          <el-button\n              type=\"primary\"\n              size=\"mini\"\n              @click=\"queryLogistics(scope.row)\"\n              :disabled=\"!scope.row.expressNo\"\n          >\n            物流追踪\n          </el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <!-- 物流详情对话框 -->\n    <el-dialog\n        title=\"物流详情\"\n        :visible.sync=\"dialogVisible\"\n        width=\"60%\"\n    >\n      <div v-if=\"loading\" class=\"loading-container\">\n        <el-icon class=\"is-loading\"><loading /></el-icon>\n        正在查询物流信息...\n      </div>\n      <div v-else-if=\"logisticsDetail\">\n        <div class=\"logistics-header\">\n          <div class=\"logistics-info\">\n            <span>快递公司：{{ getExpressCompanyName(logisticsDetail.com) }}</span>\n            <span class=\"ml-20\">快递单号：{{ logisticsDetail.nu }}</span>\n          </div>\n          <div v-if=\"logisticsDetail.state\" class=\"logistics-state\">\n            <el-tag :type=\"getStateType(logisticsDetail.state)\">\n              {{ getStateText(logisticsDetail.state) }}\n            </el-tag>\n          </div>\n        </div>\n\n        <el-timeline v-if=\"logisticsDetail.data && logisticsDetail.data.length\">\n          <el-timeline-item\n              v-for=\"(item, index) in logisticsDetail.data\"\n              :key=\"index\"\n              :timestamp=\"item.ftime || item.time\"\n              :type=\"index === 0 ? 'primary' : ''\"\n          >\n            <div class=\"timeline-content\">\n              <p class=\"context\">{{ item.context }}</p>\n              <p v-if=\"item.location\" class=\"location\">\n                <i class=\"el-icon-location\"></i> {{ item.location }}\n              </p>\n            </div>\n          </el-timeline-item>\n        </el-timeline>\n        <div v-else class=\"no-data\">\n          暂无物流信息\n        </div>\n      </div>\n      <div v-else class=\"error-container\">\n        {{ errorMsg || '物流信息获取失败' }}\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      dialogVisible: false,\n      logisticsDetail: null,\n      loading: false,\n      errorMsg: '',\n      donateRecords: [],\n      expressCompanies: {\n        'yunda': '圆通速递',\n        'zhongtong': '中通快递',\n        'shunfeng': '顺丰速运',\n        'yuantong': '圆通速递',\n        'ems': 'EMS',\n        'shentong': '申通快递',\n        'huitongkuaidi': '汇通快运',\n        'jd': '京东物流',\n        'zhaijisong': '宅急送',\n        'tiantian': '天天快递'\n      },\n      expressStates: {\n        '0': { text: '在途', type: 'info' },\n        '1': { text: '揽收', type: 'primary' },\n        '2': { text: '疑难', type: 'warning' },\n        '3': { text: '签收', type: 'success' },\n        '4': { text: '退签', type: 'danger' },\n        '5': { text: '派件', type: 'primary' },\n        '6': { text: '退回', type: 'danger' },\n        '7': { text: '转投', type: 'warning' },\n        '8': { text: '清关', type: 'info' },\n        '14': { text: '拒签', type: 'danger' }\n      }\n    }\n  },\n  created() {\n    this.load()\n  },\n  methods: {\n    load() {\n      this.request.get(\"/donate/page\", {\n        params: {\n          pageNum: 1,\n          pageSize: 10\n        }\n      }).then(res => {\n        if (res.code === '200') {\n          this.donateRecords = res.data.records\n        }\n      })\n    },\n    // 查询物流信息\n    async queryLogistics(row) {\n      if (!row.expressNo) {\n        this.$message.warning('该记录暂无快递单号')\n        return\n      }\n\n      try {\n        this.dialogVisible = true\n        this.loading = true\n        this.logisticsDetail = null\n        this.errorMsg = ''\n\n        const response = await this.request.get(`/donate/express/yuantong/${row.expressNo}`)\n        console.log('物流查询响应:', response)\n        \n        if (response.code === '200' && response.data) {\n          this.logisticsDetail = response.data\n        } else {\n          this.errorMsg = response.msg || '物流信息查询失败'\n          console.error('物流查询错误:', response)\n        }\n      } catch (error) {\n        console.error('请求错误:', error)\n        this.errorMsg = error.response?.data?.msg || error.message || '请求失败'\n      } finally {\n        this.loading = false\n      }\n    },\n    // 获取快递公司名称\n    getExpressCompanyName(code) {\n      return this.expressCompanies[code] || code\n    },\n    // 获取物流状态文本\n    getStateText(state) {\n      return this.expressStates[state]?.text || '未知状态'\n    },\n    // 获取物流状态类型\n    getStateType(state) {\n      return this.expressStates[state]?.type || 'info'\n    }\n  }\n}\n</script>\n\n<style scoped>\n.donate-container {\n  padding: 20px;\n}\n\n.logistics-header {\n  margin-bottom: 20px;\n  padding: 15px;\n  background-color: #f5f7fa;\n  border-radius: 4px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.logistics-info {\n  font-size: 16px;\n}\n\n.ml-20 {\n  margin-left: 20px;\n}\n\n.loading-container {\n  text-align: center;\n  padding: 40px 0;\n}\n\n.error-container {\n  text-align: center;\n  padding: 40px 0;\n  color: #f56c6c;\n}\n\n.no-data {\n  text-align: center;\n  padding: 40px 0;\n  color: #909399;\n}\n\n.el-timeline {\n  max-height: 400px;\n  overflow-y: auto;\n  padding: 20px;\n}\n\n.timeline-content {\n  padding: 5px 0;\n}\n\n.timeline-content .context {\n  margin: 0;\n  font-size: 14px;\n}\n\n.timeline-content .location {\n  margin: 5px 0 0;\n  font-size: 12px;\n  color: #909399;\n}\n\n.el-timeline-item:first-child {\n  color: #409EFF;\n}\n</style>\n\n\n"]}]}